
<!DOCTYPE html>
<html>
<head>
    <META http-equiv=Content-Type content="text/html; charset=UTF-8">
    <title>身份证号码</title>
    <style type="text/css">
        * {
            font-size: 14pt;
            color: #000000;
            margin: 0;
        }
        input {
            width:300px;
            height:40px;
            font-family: 'Courier New';
            font-size: 20pt;
            color: #000000;
        }
        div{
            font-family: 'Courier New';
            font-size: 14pt;
            color: #000000;
        }
        .myspan{
            display: block;
            width:20px;
        }

        .yw-stepzerobgcolor {background-color: #006600;}
        .yw-steponebgcolor {background-color: #CC0000; }
        .yw-steptwobgcolor {background-color: #CC0000;}
        .yw-stepthreebgcolor {background-color: #000099; }
        .yw-changebgcolor {background-color: #aa0099; }
        .yw-logoutbgcolor {background-color: darkslategrey; }
        #yw-block{
            height: 14px;
        }
        #yw-block > div{

            width: 12px;
            height: 12px;
            float: left;
        }
        #yw-block > span{
            line-height:14px;
            display: block;
            float: left;
        }
    </style>
</head>
<body>

<div id="yw-block">
    <div class="yw-stepzerobgcolor"></div><span>申请</span>
    <div class="yw-steponebgcolor"></div><span>提交</span>
    <div class="yw-steptwobgcolor"></div><span>审核</span>
    <div class="yw-stepthreebgcolor"></div><span>审批</span>
    <div class="yw-changebgcolor"></div><span>变更</span>
    <div class="yw-logoutbgcolor"></div><span>注销</span>
</div>

<input type="text" id="myid" >
<div id='otherid'></div>
</body>
<script type="text/javascript">

    var generalid=function(code){
        var tmp;
        code+='';
        var len=code.length;
        if(len<17){
            //if(len>0){alert('身份证号码不足十七位');}
            return code;
        }
        tmp = code.split('');
        //∑(ai×Wi)(mod 11)
        //加权因子
        var factor = [ 7, 9, 10, 5, 8, 4, 2, 1, 6, 3, 7, 9, 10, 5, 8, 4, 2 ];
        //校验位
        var parity = [ 1, 0, 'X', 9, 8, 7, 6, 5, 4, 3, 2 ];
        var sum = 0;
        var ai = 0;
        var wi = 0;
        for (var i = 0; i < 17; i++) {
            ai = tmp[i];
            wi = factor[i];
            sum += ai * wi;
        }
        var last = parity[sum % 11];
        return code.substr(0,17)+last;
    }
    window.onload=function(){
        document.getElementById('yw-block').addEventListener('click',function(e){
            window.open('','','');
        })


        var re = /^\d{6}((18)|(19)|(20))\d{2}((0[1-9])|(1[012]))((0[1-9])|([12]\d)|(3[01]))\d{3}(\d|X)$/i;
        var myid=document.getElementById('myid');
        var d=new Date();
        var month=d.getMonth()==12?'01':(d.getMonth()+1)+'';
        month=month.length==2?month:'0'+month;
        var date= (d.getDate()+'').length==2?d.getDate():'0'+d.getDate();
        myid.value='3304241987'+ month+ date+ Math.round(Math.random()*10000);
        if(window.event){

            try{
                myid.attachEvent('onkeydown',fn)
            }catch(e){
                myid.addEventListener('keydown',fn)
            }
        }else{
            myid.addEventListener('keydown',fn)
        }
        function fn(e){
            e=window.event||e;
            var keyPressed;
            if (window.event){
                keyPressed = window.event.keyCode; // IE
            }
            else{
                keyPressed = e.which; // Firefox
            }
            if(keyPressed== 13){
                myid.value=generalid(this.value);
                var mycode0=myid.value.substr(0,6);
                var mycode1=myid.value.substr(6,4);
                var mycode2=myid.value.substr(10,6);
                var otherresult='';
                var count=1;

                var currentYear=new Number(d.getFullYear());
                for(var i=currentYear-80;i<currentYear;i++){
                    if(i==new Number(mycode1)){
                        continue;
                    }

                    var o=generalid(mycode0+i+mycode2+Math.round(Math.random()*10));
                    if(!re.test(o)){
                        continue;
                    }
                    otherresult+=o+'<span class="myspan"></span>'
                    if(count%6==0){
                        otherresult+='<br/><br/>';
                    }
                    count++;

                }
                document.getElementById('otherid').innerHTML='<table>'+otherresult+'</table>';
            }
        }
    }

</script>
</html>
